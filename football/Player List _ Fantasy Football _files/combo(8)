/*
YUI 3.18.1 (build f7e7bcb)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("async-queue",function(e,t){e.AsyncQueue=function(){this._init(),this.add.apply(this,arguments)};var n=e.AsyncQueue,r="execute",i="shift",s="promote",o="remove",u=e.Lang.isObject,a=e.Lang.isFunction;n.defaults=e.mix({autoContinue:!0,iterations:1,timeout:10,until:function(){return this.iterations|=0,this.iterations<=0}},e.config.queueDefaults||{}),e.extend(n,e.EventTarget,{_running:!1,_init:function(){e.EventTarget.call(this,{prefix:"queue",emitFacade:!0}),this._q=[],this.defaults={},this._initEvents()},_initEvents:function(){this.publish({execute:{defaultFn:this._defExecFn,emitFacade:!0},shift:{defaultFn:this._defShiftFn,emitFacade:!0},add:{defaultFn:this._defAddFn,emitFacade:!0},promote:{defaultFn:this._defPromoteFn,emitFacade:!0},remove:{defaultFn:this._defRemoveFn,emitFacade:!0}})},next:function(){var e;while(this._q.length){e=this._q[0]=this._prepare(this._q[0]);if(!e||!e.until())break;this.fire(i,{callback:e}),e=null}return e||null},_defShiftFn:function(e){this.indexOf(e.callback)===0&&this._q.shift()},_prepare:function(t){if(a(t)&&t._prepared)return t;var r=e.merge(n.defaults,{context:this,args:[],_prepared:!0},this.defaults,a(t)?{fn:t}:t),i=e.bind(function(){i._running||i.iterations--,a(i.fn)&&i.fn.apply(i.context||e,e.Array(i.args))},this);return e.mix(i,r)},run:function(){var e,t=!0;if(this._executing)return this._running=!0,this;for(e=this.next();e&&!this.isRunning();e=this.next()){t=e.timeout<0?this._execute(e):this._schedule(e);if(!t)break}return e||this.fire("complete"),this},_execute:function(e){this._running=e._running=!0,this._executing=e,e.iterations--,this.fire(r,{callback:e});var t=this._running&&e.autoContinue;return this._running=e._running=!1,this._executing=!1,t},_schedule:function(t){return this._running=e.later(t.timeout,this,function(){this._execute(t)&&this.run()}),!1},isRunning:function(){return!!this._running},_defExecFn:function(e){e.callback()},add:function(){return this.fire("add",{callbacks:e.Array(arguments,0,!0)}),this},_defAddFn:function(t){var n=this._q,r=[];e.Array.each(t.callbacks,function(e){u(e)&&(n.push(e),r.push(e))}),t.added=r},pause:function(){return this._running&&u(this._running)&&this._running.cancel(),this._running=!1,this},stop:function(){return this._q=[],this._running&&u(this._running)&&(this._running.cancel(),this._running=!1),this._executing||this.run(),this},indexOf:function(e){var t=0,n=this._q.length,r;for(;t<n;++t){r=this._q[t];if(r===e||r.id===e)return t}return-1},getCallback:function(e){var t=this.indexOf(e);return t>-1?this._q[t]:null},promote:function(e){var t={callback:e},n;return this.isRunning()?n=this.after(i,function(){this.fire(s,t),n.detach()},this):this.fire(s,t),this},_defPromoteFn:function(e){var t=this.indexOf(e.callback),n=t>-1?this._q.splice(t,1)[0]:null;e.promoted=n,n&&this._q.unshift(n)},remove:function(e){var t={callback:e},n;return this.isRunning()?n=this.after(i,function(){this.fire(o,t),n.detach()},this):this.fire(o,t),this},_defRemoveFn:function(e){var t=this.indexOf(e.callback);e.removed=t>-1?this._q.splice(t,1)[0]:null},size:function(){return this.isRunning()||this.next(),this._q.length}})},"3.18.1",{requires:["event-custom"]});
YUI.add("media-rmp",function(e){var t=/<style([^>]*)>([^<]+)<\/style>/igm,n=/@import\s*url\s*\(([^\)]*?)\);/igm,r=/<link([^>]*)/igm,i=/href=(['"]?)([^"']*)\1/igm,s="/_remote/",o="_@_!_",u=/_@_!_/igm,a="RMPClient",f=/(http[^\?]*?\/combo)\?(.*)/igm,l=/^--dali-response-split(?:-[a-z0-9]+)?/gm,c="request-manager:",h={srcNode:null,params:{m_id:"MediaRemoteInstance",m_mode:"fragment",instance_id:null},baseUrl:"",onAbort:function(e){},onFailure:function(e,t){},onSuccess:function(e){},onComplete:function(e){},onJson:function(e){},onMarkup:function(t){var n=this,r=e.one(n.config.srcNode);r.set("innerHTML",n.markup),r.setStyle("minHeight",""),r.removeClass("yom-loading")},data:{},context:null,timeout:1e3,continueOnError:!1,path:s},p=function(t){var n=this,r=t||{},i;r.params=e.merge(h.params,r.params||{}),!r.params.instance_id&&!r.path&&!r.response&&(i="RMP config requires instance_id, path, or response."),!r.srcNode&&!r.onMarkup&&(i="RMP config requires srcNode or onMarkup."),h.context=n,r=n.config=e.merge(h,t||{});if(i){n._errorHandler({message:i});return}n.error=!1,n.config.continueOnJsError=typeof n.config.continueOnJsError!="undefined"?n.config.continueOnJsError:n.config.continueOnError,n.config.continueOnCssError=typeof n.config.continueOnCssError!="undefined"?n.config.continueOnCssError:n.config.continueOnError,n.markup="",n.jsUrls=[],n.cssUrls=[],n.inlineCSS=[],n._cssComplete=!1,n.embedInlineJs=[],n.markupInlineJs=[],n.request=null};p.prototype={load:function(){var t=this,n=t.config,r=n.params.instance_id,i=n.srcNode,s=t._getRMPUrl(n),o,u="";if(t.error)return!0;e.Global.on(c+"accessStorageData",function(e){u=sessionStorage[e];if(undefined!==u&&null!==u&&u.indexOf("--dali-response-split")!==-1)return t._load({responseText:u}),!0});if(n.response)return t._load({responseText:n.response}),!0;t.request=e.io(s,{timeout:n.timeout,context:t,on:{success:function(e,n){try{t._load(n)}catch(r){t._errorHandler(r)}},failure:function(e,n){n&&"abort"===n.statusText?t._abortHandler():t._errorHandler({message:"Y.io call failed in RMP.load()"})}}})},getRequest:function(){return this.request},_getRMPUrl:function(){var e=[],t=this,n=t.config,r;for(r in n.params)e.push(encodeURIComponent(r)+"="+encodeURIComponent(n.params[r]).replace(/'/g,"%27"));return n.baseUrl+n.path+"?"+e.join("&")},_load:function(t){var n=this,r=n.config,i="getResponseHeader"in t?t.getResponseHeader("Content-Type").split(";"):[],o=r.response||i[0]==="multipart/mixed"||r.params.m_mode==="multipart",u=r.path.indexOf(s)===-1,a="",f="",c;if(o||u)try{var h=e.Lang.trim(t.responseText).replace(/\r/g,"").split(l).slice(0,-1),p="\n\n";if(h.length===0){n._errorHandler({message:"Not multipart response"});return}e.Array.each(h,function(t){var n=t.indexOf(p),r=t.slice(n+p.length),i=t.slice(0,n).split("\n"),s={};e.Array.each(i,function(e){if(e){var t=e.split(": ");s[t[0]]=t[1].split("; ")[0]}});switch(s["Content-Type"]){case"text/plain":f+=" "+r;break;case"text/html":a=r;break;case"application/json":c=r}})}catch(d){return}else a=t.responseText,f=n._decode(t.getResponseHeader("X-Maple-Embed-Blob"));c&&n.config.onJson(c),n._parse(a,f),n._loadFiles()},_decode:function(e){return e=e.replace(/%2B/g,o),e=decodeURIComponent(e).replace(/\+/igm," ").replace(u,"+"),e},_parse:function(e,t){var n=this;n.markup=e,n.config.loadCss!==!1&&(n._parseCSS(t),n._parseCSS(e)),n.config.loadJs!==!1&&(n._parseJS(t,!1),n._parseJS(e,!0)),n._parseDuplicates()},_parseCSS:function(s,o){var u=this,a=[],f=t.exec(s),l,c,h,p,d,v,m;while(f){l=f[2];if(l){c=new RegExp(n),h=c.exec(l);while(h){for(p=0,d=h.length;p<d;p++);v=h[1],u._isValidAssetUrl(v)&&a.push(v),h=c.exec(l)}}l=l.replace(n,""),e.Lang.trim(l)!=""&&u.inlineCSS.push(l),f=t.exec(s)}f=r.exec(s);while(f){var g=f[1];g&&(m=i.exec(g),m&&(v=m[2],u._isValidAssetUrl(v)&&a.push(v),i.exec(g))),f=r.exec(s)}if(o)return a;a.length&&(u.cssUrls=u.cssUrls.concat(a))},_isValidAssetUrl:function(e){return!e||e.indexOf("http")!==0?!1:e.lastIndexOf("js")===e.length-2||e.lastIndexOf("css")===e.length-3},_parseJS:function(t,n){var r=e.Node.create("<div></div>"),i=this,s,o,u;r.setContent(t),s=r.all("script").each(function(e){e.get("parentNode").removeChild(e)}),s.each(function(e){o=null,e&&(o=e.get("src")),i._isValidAssetUrl(o)?i.jsUrls.push(o):(u=e.get("type"),u===""||u==="text/javascript"?n?i.markupInlineJs.push(e):i.embedInlineJs.push(e):u==="text/plain"&&!n&&(i.markup+=e.get("outerHTML")))})},_parseDuplicates:function(){var t=this,n,r,i,s,o,u;o=YUI.namespace("Media.RMP"),o.assetsAlreadyLoaded||(o.assetsAlreadyLoaded=[],u=e.one("head"),u.all("> script[src]").each(function(e){n=e.get("src"),t._removeDuplicates([n])}),t._removeDuplicates(t._parseCSS(u._node.innerHTML,!0))),t.cssUrls=t._removeDuplicates(t.cssUrls),t.jsUrls=t._removeDuplicates(t.jsUrls)},_removeDuplicates:function(e){var t=this,n=[],r,i,s;for(i=0,s=e.length;i<s;i++)r=t._processUrl(e[i]),r&&n.push(r);return n},_processUrl:function(t){var n,r,i,s,o,u,a,l=new RegExp(f),c=l.exec(t),h=YUI.Media.RMP.assetsAlreadyLoaded;if(c){r=c[1],n=c[2].replace(/&amp;/g,"&").split("&"),i=[];for(u=0,a=n.length;u<a;u++)e.Array.indexOf(h,n[u])==-1&&(h.push(n[u]),i.push(n[u]));return i.length>0?r+"?"+i.join("&"):null}return e.Array.indexOf(h,t)==-1?(h.push(t),t):null},_loadFiles:function(){var t=this;t.cssUrls.length>0?e.Get.css(t.cssUrls,{context:t,async:!0,onFailure:t._onCssFailure,onSuccess:t._onCssSuccess}):t._onCssSuccess(),t.jsUrls.length>0?e.Get.js(t.jsUrls,{context:t,async:!1,onFailure:t._onJsFailure,onSuccess:t._onJsSuccess}):t._onJsSuccess(),t._executeInlineCss()},_onCssSuccess:function(e){var t=this;t._cssComplete||(t._injectMarkUp(),t._jsComplete&&t._handleInlineJs()),t._cssComplete=!0},_onJsSuccess:function(e){var t=this;!t._jsComplete&&t._cssComplete&&t._handleInlineJs(),t._jsComplete=!0},_onCssFailure:function(e){var t=this,n=t.config;!t._cssComplete&&!n.continueOnCssError&&t._errorHandler({message:"Y.Get.css failed",cause:e,type:"css"}),t._cssComplete=!0},_onJsFailure:function(e){var t=this,n=t.config
;!t._jsComplete&&!n.continueOnJsError&&t._errorHandler({message:"Y.Get.script failed",cause:e,type:"js"}),t._jsComplete=!0},_jsComplete:!1,_cssComplete:!1,_handleInlineJs:function(){var e=this,t=e.config;if(e._done||e.error)return;try{e._executeScript(),e._completionHandler()}catch(n){e._errorHandler(n)}e._done=!0},_done:!1,_executeInlineCss:function(){var t=this,n=t.config,r,i,s;for(i=0,s=t.inlineCSS.length;i<s;i++){r=document.createElement("style"),r.type="text/css",e.Lang.isObject(r.styleSheet)?r.styleSheet.cssText=t.inlineCSS[i]:r.appendChild(document.createTextNode(t.inlineCSS[i]));try{document.getElementsByTagName("head")[0].appendChild(r)}catch(o){if(!t.config.continueOnCssError){t._errorHandler({message:"Inline css execute failed",cause:o,type:"css"});return}}}},_injectMarkUp:function(){var e=this,t=e.config;if(!e.error)try{e._callUserCallback(t.context,t.onMarkup,[t.data])}catch(n){e._errorHandler({message:"Markup failed",cause:n,type:"markup"})}},_executeScript:function(){var t=this,n,r,i,s;e.Media.RMP.id||(e.Media.RMP.id="_ts"+(new Date).getTime()),i=e.Media.RMP.id,YUI.RMP||YUI.namespace("RMP"),YUI.RMP[i]||(YUI.RMP[i]={currentYSandBox:e}),YUI.RMP[i].proxyAdd||(YUI.RMP[i].proxyAdd=function(e,t,n){var r=YUI.RMP[i].currentYSandBox;r.use("event",function(e){e.Event.attach("load",n,window)})}),s=t.markupInlineJs.concat(t.embedInlineJs),s.length>0&&t._insertInlineJS(s)},_insertInlineJS:function(t){var n=this,r=e.config.doc,i=e.one("head"),s=e.one(r.createElement("script")),o=e.Media.RMP.id,u="",a;for(var f=0,l=t.length;f<l;f++)t[f]&&(u+=";"+t[f]._node.text.replace("YUI.Env.add","YUI.RMP['"+o+"'].proxyAdd").replace("YUI(YUI.YUICfg).use","YUI.RMP['"+o+"'].currentYSandBox.applyConfig(YUI.YUICfg);YUI.RMP['"+o+"'].currentYSandBox.use"));u.length>0&&(s._node.text=u,a=document.write,document.write=n._documentWriteOverride,i.appendChild(s),document.write=a)},_abortHandler:function(){var e=this,t=e.config;e._callUserCallback(t.context,t.onAbort,[t.data]),e._callUserCallback(t.context,t.onComplete,[t.data])},_errorHandler:function(e){var t=this,n=t.config;t.error=!0,t._callUserCallback(n.context,n.onFailure,[e,n.data]),t._callUserCallback(n.context,n.onComplete,[n.data])},_completionHandler:function(){var t=this,n=t.config;e.Object.getValue(e,["Global","Media","ILBoot"])!==undefined&&e.Global.Media.ILBoot.initImageLoader(!0),t._callUserCallback(n.context,n.onSuccess,[n.data]),t._callUserCallback(n.context,n.onComplete,[n.data])},_callUserCallback:function(e,t,n){t.apply(e||this,n)},_documentWriteOverride:function(e){}},e.namespace("Media.RMP").load=function(e){var t=new p(e);return t.load(),t}},"@VERSION@",{requires:["node","io-base","async-queue","get"]});
